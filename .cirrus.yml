container:
  image: node:10

lint_task:
  install_script: npm install
  test_script: npm run lint

test_task:
  container:
    matrix:
      image: node:11
      image: node:10
      image: node:8
  install_script: npm install
  test_script: npm test

commit_lint_task:
  script:
    - npm install
    - npm run commitlint

coverage_task:
  env:
    CODECOV_TOKEN: ENCRYPTED[9add171b436ba748661210b916536d56fe932283ad9f886af42b3524fd6afb82c17a95b6fa8cccd7ab0b9f94ac08f812]
  script:
    - npm install
    - npm test
    - npm run codecov

publish_task:
  only_if: $CIRRUS_BRANCH == 'master'
  depends_on:
    - test_task
    - lint_task
    - commit_lint_task
  environment:
    GITHUB_TOKEN: ENCRYPTED[af3c089bdc078ef8f0b7e0cff554ab14b4b3a0dd3806af9a66fcab064c92e67e21502b7143ca126cf78760dfbce670ea]
    NPM_TOKEN: ENCRYPTED[8b66b7c827a85a560fd6665ec768714cef489e35ab636c4e2aa8142e15a407fec6839f09074a09ed244078fae66d69f0]
  script:
    - npm install
    - npm run compile
    - npx semantic-release
